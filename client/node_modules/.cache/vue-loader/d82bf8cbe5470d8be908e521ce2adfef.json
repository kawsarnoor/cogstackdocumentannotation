{"remainingRequest":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/src/components/Document.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/src/components/Document.vue","mtime":1606868506726},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qZXNsaW50LWRpc2FibGUqLwoKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHJhbmd5IGZyb20gJ3Jhbmd5JzsKaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JzsKaW1wb3J0IHsgRXZlbnRCdXMgfSBmcm9tICIuLi9tYWluLmpzIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRG9jdW1lbnQnLAogIHByb3BzOiB7CiAgICBtc2c6IFN0cmluZywKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwcm9qZWN0X2lkOiBOdW1iZXIsCiAgICAgIGF2YWlsYWJsZV9sYWJlbHM6IFtdLAogICAgICBhdmFpbGFibGVfbGFiZWxfaWRzOiBbXSwKICAgICAgZG9jdW1lbnRfdGV4dDogJycsCiAgICAgIGxhYmVsczogW10sCiAgICAgIHNwYW5zOiB7fSwKICAgICAgc3BhbnZhbHVlczogW10sCiAgICAgIGN1cnJlbnRpZHg6IE51bWJlciwgLy8gdGhpcyBpcyBjdXJyZW50IGRvY3VtZW50X2lkeAogICAgICByb290X2FwaTogcHJvY2Vzcy5lbnYuVlVFX0FQUF9VUkwsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgCiAgICByZXRyaWV2ZUFubm90YXRlZERvY3VtZW50KGlkeCkgewogICAgICBjb25zdCBhbm5fZG9jdW1lbnRfcGF0aHBhdGggPSAnaHR0cDovLycgKyB0aGlzLnJvb3RfYXBpICsgJzo1MDAxL2dldEFubm90YXRlZERvY3VtZW50JzsKICAgICAgYXhpb3MucG9zdChhbm5fZG9jdW1lbnRfcGF0aHBhdGgsIHsnZG9jdW1lbnRfaWQnOiBpZHh9LCB7aGVhZGVyczogeydBdXRob3JpemF0aW9uJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dCcpfX0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy5sYWJlbHMgPSByZXMuZGF0YS5sYWJlbF9pZHM7CiAgICAgICAgICBjb25zb2xlLmxvZygncmV0cmlldmUgYW5ub3RhdGVkIGRvY3VtZW50JywgaWR4KQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgfSk7ICAgCiAgICB9LAoKICAgIGxvYWRQcm9qZWN0KHByb2plY3RfaWQpIHsKICAgICAgY29uc3QgcGF0aCA9ICdodHRwOi8vJyArIHRoaXMucm9vdF9hcGkgKyAnOjUwMDEvZ2V0UHJvamVjdCc7CiAgICAgIGF4aW9zLnBvc3QocGF0aCwgeydwcm9qZWN0X2lkJzogcHJvamVjdF9pZH0sIHtoZWFkZXJzOiB7J0F1dGhvcml6YXRpb24nOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0Jyl9fSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmF2YWlsYWJsZV9sYWJlbHMgPSByZXMuZGF0YS5hdmFpbGFibGVfbGFiZWxzOwogICAgICAgICAgdGhpcy5hdmFpbGFibGVfbGFiZWxfaWRzID0gcmVzLmRhdGEuYXZhaWxhYmxlX2xhYmVsX2lkczsKICAgICAgICAgIGNvbnNvbGUubG9nKCdsb2FkZWQgYXZhaWxhYmxlIGxhYmVscycpCiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICB9KTsgICAgICAKICAgIH0sCgogICAgZ2V0bmV4dGRvY3VtZW50KG5ld0lkeCkgewogICAgICBjb25zdCBkb2N1bWVudF9wYXRoID0gJ2h0dHA6Ly8nICsgdGhpcy5yb290X2FwaSArICc6NTAwMS9nZXREb2N1bWVudCc7CiAgICAgIGF4aW9zLnBvc3QoZG9jdW1lbnRfcGF0aCwgeydkb2N1bWVudF9pZCc6IG5ld0lkeH0sIHtoZWFkZXJzOiB7J0F1dGhvcml6YXRpb24nOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0Jyl9fSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmRvY3VtZW50X3RleHQgPSByZXMuZGF0YS5kb2N1bWVudF90ZXh0OwogICAgICAgICAgLy8gdGhpcy5kb2N1bWVudF90ZXh0ID0gdGhpcy5kb2N1bWVudF90ZXh0LnJlcGxhY2UobmV3IFJlZ0V4cCgnXHI/XG4nLCdnJyksICc8YnIvPicpOwogICAgICAgICAgdGhpcy5yZXRyaWV2ZUFubm90YXRlZERvY3VtZW50KG5ld0lkeCk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICB9KTsKCiAgICB9LAoKICAgIGNoYW5nZWxhYmVsKGxhYmVsX2lkKSB7CiAgICAgIGNvbnN0IHBhdGggPSAnaHR0cDovLycgKyB0aGlzLnJvb3RfYXBpICsgJzo1MDAxL2NoYW5nZWxhYmVsJzsKCiAgICAgIGF4aW9zLnBvc3QocGF0aCwgeyAnbGFiZWxfaWQnOiBsYWJlbF9pZCwgJ2RvY3VtZW50X2lkJzogdGhpcy5jdXJyZW50aWR4LCAncHJvamVjdF9pZCc6IHRoaXMucHJvamVjdF9pZH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHtoZWFkZXJzOiB7J0F1dGhvcml6YXRpb24nOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0Jyl9fSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgibGFiZWwtYWRkZWQiLCB0aGlzLmN1cnJlbnRpZHgpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgfSk7CiAgICB9LAoKICB9LAoKICBjcmVhdGVkKCkgewogICAgdGhpcy5wcm9qZWN0X2lkID0gMTsgLy8gcmVwbGFjZSB0aGlzIHdpdGggYSBjYWxsIHRvIHRoZSBhcGkhCiAgICB0aGlzLmN1cnJlbnRpZHggPSAxOyAvLyByaXNreS4udGhlIHN0YXJ0aW5nIGNvZGVyIG1pZ2h0IG5vdCBiZSBzZXQgdXAKICAgIGNvbnNvbGUubG9nKCdEb2N1bWVudCBsb2FkZWQgd2l0aCBjaWQ6ICcsIHRoaXMuY3VycmVudGlkeCk7CgogICAgdGhpcy5sb2FkUHJvamVjdCh0aGlzLnByb2plY3RfaWQpOyAvLyB0aGlzIGdpdmVzIHVzIHRoZSBhdmFpbGFibGUgbGFiZWxzCiAgICB0aGlzLmdldG5leHRkb2N1bWVudCgxKTsKCiAgICAvLyBFdmVudCBsaXN0ZW5lciBmb3IgcHJldmlvdXMgYW5kIG5leHQgZG9jdW1lbnQKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHsKICAgICAgaWYgKGUua2V5ID09ICd5JykgewogICAgICAgIHRoaXMuY2hhbmdlbGFiZWwoMik7CiAgICAgIH0KICAgICAgaWYgKGUua2V5ID09ICduJykgewogICAgICAgIHRoaXMuY2hhbmdlbGFiZWwoMSk7CiAgICAgIH0KICAgIH0pOwoKICAgIEV2ZW50QnVzLiRvbigibnVtYmVyLWFkZGVkIiwgbmV3SWR4ID0+IHsKICAgICAgdGhpcy5jdXJyZW50aWR4ID0gbmV3SWR4OwogICAgICB0aGlzLmdldG5leHRkb2N1bWVudChuZXdJZHgpOwogICAgICAKICAgIH0pOwogIH0sCn07Cg=="},{"version":3,"sources":["Document.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmCA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"Document.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<!-- eslint-disable max-len -->\n  <div class=\"document\">\n    <div class=\"card text-center\">\n      <div class=\"card-header\">\n        <div class=\"category\">\n          <div class=\"row\">\n            <div class=\"col-12\">\n              <div class=\"btn-group\" role=\"group\" v-for=\"(label, idx) in available_labels\" :key=\"label\">\n                    <!-- <button v-if=\"value == false\" class=\"btn btn-secondary\" type=\"button\" @click=\"changeValue(label, 'themes', labels.id)\">{{label}} </button>\n                    <button v-if=\"value == true\" class=\"btn btn-primary\" type=\"button\" @click=\"showSpans(label, 'themes', labels.id)\">{{label}} </button>\n                    <button v-if=\"value == true\" class=\"btn btn-warning\" type=\"button\" @click=\"changeValue(label, 'themes', labels.id)\">&#10008;</button>\n                    <button v-if=\"value == true\" class=\"btn btn-warning\" type=\"button\" @click=\"linkTexttoLabel(label, 'themes', labels.id)\">&#10078;</button> -->\n                    <button v-if=\"labels.includes(available_label_ids[idx])\" class=\"btn btn-primary\" type=\"button\" @click=\"changelabel(available_label_ids[idx])\"> {{label}} </button>\n                    <button v-else class=\"btn btn-secondary\" type=\"button\" @click=\"changelabel(available_label_ids[idx])\"> {{label}} </button>\n              </div>\n            </div>\n            <!-- <div class=\"col-2\">\n              <form class=\"form-inline\">\n                <input type=\"text\" id=\"themes-new\" class=\"form-control search\" placeholder=\"new label\" @keyup.enter=\"addlabel('themes-new')\">\n              </form>\n            </div> -->\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body\" id='document_text'>\n        <p class=\"card-text overflowAuto\">\n          <pre>{{document_text}}</pre>\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/*eslint-disable*/\n\nimport axios from 'axios';\nimport rangy from 'rangy';\nimport $ from 'jquery';\nimport { EventBus } from \"../main.js\";\n\nexport default {\n  name: 'Document',\n  props: {\n    msg: String,\n  },\n  data() {\n    return {\n      project_id: Number,\n      available_labels: [],\n      available_label_ids: [],\n      document_text: '',\n      labels: [],\n      spans: {},\n      spanvalues: [],\n      currentidx: Number, // this is current document_idx\n      root_api: process.env.VUE_APP_URL,\n    };\n  },\n  methods: {\n    \n    retrieveAnnotatedDocument(idx) {\n      const ann_document_pathpath = 'http://' + this.root_api + ':5001/getAnnotatedDocument';\n      axios.post(ann_document_pathpath, {'document_id': idx}, {headers: {'Authorization': localStorage.getItem('jwt')}})\n        .then((res) => {\n          this.labels = res.data.label_ids;\n          console.log('retrieve annotated document', idx)\n        })\n        .catch((error) => {\n          console.error(error);\n        });   \n    },\n\n    loadProject(project_id) {\n      const path = 'http://' + this.root_api + ':5001/getProject';\n      axios.post(path, {'project_id': project_id}, {headers: {'Authorization': localStorage.getItem('jwt')}})\n        .then((res) => {\n          this.available_labels = res.data.available_labels;\n          this.available_label_ids = res.data.available_label_ids;\n          console.log('loaded available labels')\n        })\n        .catch((error) => {\n          console.error(error);\n        });      \n    },\n\n    getnextdocument(newIdx) {\n      const document_path = 'http://' + this.root_api + ':5001/getDocument';\n      axios.post(document_path, {'document_id': newIdx}, {headers: {'Authorization': localStorage.getItem('jwt')}})\n        .then((res) => {\n          this.document_text = res.data.document_text;\n          // this.document_text = this.document_text.replace(new RegExp('\\r?\\n','g'), '<br/>');\n          this.retrieveAnnotatedDocument(newIdx);\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n\n    },\n\n    changelabel(label_id) {\n      const path = 'http://' + this.root_api + ':5001/changelabel';\n\n      axios.post(path, { 'label_id': label_id, 'document_id': this.currentidx, 'project_id': this.project_id},\n                        {headers: {'Authorization': localStorage.getItem('jwt')}})\n        .then((res) => {\n          EventBus.$emit(\"label-added\", this.currentidx);\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n    },\n\n  },\n\n  created() {\n    this.project_id = 1; // replace this with a call to the api!\n    this.currentidx = 1; // risky..the starting coder might not be set up\n    console.log('Document loaded with cid: ', this.currentidx);\n\n    this.loadProject(this.project_id); // this gives us the available labels\n    this.getnextdocument(1);\n\n    // Event listener for previous and next document\n    window.addEventListener('keydown', (e) => {\n      if (e.key == 'y') {\n        this.changelabel(2);\n      }\n      if (e.key == 'n') {\n        this.changelabel(1);\n      }\n    });\n\n    EventBus.$on(\"number-added\", newIdx => {\n      this.currentidx = newIdx;\n      this.getnextdocument(newIdx);\n      \n    });\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\ninput {\n  margin: 3px;\n}\nh3 {\n  margin: 0px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n.category {\n  text-align: left;\n  margin-top: 15px;\n}\n.overflowAuto {\n  overflow-y: auto;\n  height: 75vh;\n  word-wrap: break-word;\n}\n.document {\n  margin: 15px;\n}\n.btn-group {\n  margin: 5px;\n}\ndiv.boxwrap div {\n  float: left;\n}\ndiv.boxwrap div:hover {\n  background-color: aqua;\n  cursor: pointer;\n}\ndiv.boxwrap div h5 {\n  text-align: center;\n}\npre {\n  white-space: pre-wrap;\n  word-break: keep-all\n}\n</style>\n"]}]}