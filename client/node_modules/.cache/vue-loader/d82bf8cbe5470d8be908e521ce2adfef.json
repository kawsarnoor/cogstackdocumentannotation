{"remainingRequest":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/src/components/Document.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/src/components/Document.vue","mtime":1613431816977},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qZXNsaW50LWRpc2FibGUqLwoKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHJhbmd5IGZyb20gJ3Jhbmd5JzsKaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JzsKaW1wb3J0IHsgRXZlbnRCdXMgfSBmcm9tICIuLi9tYWluLmpzIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRG9jdW1lbnQnLAogIHByb3BzOiB7CiAgICBtc2c6IFN0cmluZywKICAgIHByb2plY3RpZDogTnVtYmVyLAogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhdmFpbGFibGVfbGFiZWxzOiBbXSwKICAgICAgYXZhaWxhYmxlX2xhYmVsX2lkczogW10sCiAgICAgIGRvY3VtZW50X3RleHQ6ICcnLAogICAgICBsYWJlbHM6IFtdLAogICAgICBzcGFuczoge30sCiAgICAgIHNwYW52YWx1ZXM6IFtdLAogICAgICBjdXJyZW50aWR4OiBOdW1iZXIsIC8vIHRoaXMgaXMgY3VycmVudCBkb2N1bWVudF9pZHgKICAgICAgcm9vdF9hcGk6IHByb2Nlc3MuZW52LlZVRV9BUFBfVVJMLAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIAogICAgcmV0cmlldmVBbm5vdGF0ZWREb2N1bWVudChpZHgpIHsKICAgICAgY29uc3QgYW5uX2RvY3VtZW50X3BhdGhwYXRoID0gJ2h0dHA6Ly8nICsgdGhpcy5yb290X2FwaSArICc6NTAwMS9nZXRBbm5vdGF0ZWREb2N1bWVudCc7CiAgICAgIGF4aW9zLnBvc3QoYW5uX2RvY3VtZW50X3BhdGhwYXRoLCB7J2RvY3VtZW50X2lkJzogaWR4fSwge2hlYWRlcnM6IHsnQXV0aG9yaXphdGlvbic6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdqd3QnKX19KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMubGFiZWxzID0gcmVzLmRhdGEubGFiZWxfaWRzOwogICAgICAgICAgY29uc29sZS5sb2coJ3JldHJpZXZlIGFubm90YXRlZCBkb2N1bWVudCcsIGlkeCkKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgIH0pOyAgIAogICAgfSwKCiAgICBsb2FkUHJvamVjdCgpIHsKICAgICAgY29uc3QgcGF0aCA9ICdodHRwOi8vJyArIHRoaXMucm9vdF9hcGkgKyAnOjUwMDEvZ2V0UHJvamVjdCc7CiAgICAgIGF4aW9zLnBvc3QocGF0aCwgeydwcm9qZWN0X2lkJzogdGhpcy5wcm9qZWN0aWR9LCB7aGVhZGVyczogeydBdXRob3JpemF0aW9uJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dCcpfX0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy5hdmFpbGFibGVfbGFiZWxzID0gcmVzLmRhdGEuYXZhaWxhYmxlX2xhYmVsczsKICAgICAgICAgIHRoaXMuYXZhaWxhYmxlX2xhYmVsX2lkcyA9IHJlcy5kYXRhLmF2YWlsYWJsZV9sYWJlbF9pZHM7CiAgICAgICAgICBjb25zb2xlLmxvZygnbG9hZGVkIGF2YWlsYWJsZSBsYWJlbHMnKQogICAgICAgICAgdmFyIHN0YXJ0aW5nX2RvY3VtZW50X2lkID0gcmVzLmRhdGEuc3RhcnRpbmdfZG9jdW1lbnRfaWQ7CiAgICAgICAgICB0aGlzLmdldG5leHRkb2N1bWVudChzdGFydGluZ19kb2N1bWVudF9pZCk7IC8vIHRoaXMgbmVlZHMgdG8gYmUgbG9nZ2VkIHRvIGRhdGFzZXQgYW5kIG5vdCBkb2N1bWVudAoKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgIH0pOyAgICAgIAogICAgfSwKCiAgICBnZXRuZXh0ZG9jdW1lbnQobmV3SWR4KSB7CiAgICAgIGNvbnN0IGRvY3VtZW50X3BhdGggPSAnaHR0cDovLycgKyB0aGlzLnJvb3RfYXBpICsgJzo1MDAxL2dldERvY3VtZW50JzsKICAgICAgYXhpb3MucG9zdChkb2N1bWVudF9wYXRoLCB7J2RvY3VtZW50X2lkJzogbmV3SWR4fSwge2hlYWRlcnM6IHsnQXV0aG9yaXphdGlvbic6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdqd3QnKX19KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuZG9jdW1lbnRfdGV4dCA9IHJlcy5kYXRhLmRvY3VtZW50X3RleHQ7CiAgICAgICAgICAvLyB0aGlzLmRvY3VtZW50X3RleHQgPSB0aGlzLmRvY3VtZW50X3RleHQucmVwbGFjZShuZXcgUmVnRXhwKCdccj9cbicsJ2cnKSwgJzxici8+Jyk7CiAgICAgICAgICB0aGlzLnJldHJpZXZlQW5ub3RhdGVkRG9jdW1lbnQobmV3SWR4KTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgIH0pOwoKICAgIH0sCgogICAgY2hhbmdlbGFiZWwobGFiZWxfaWQpIHsKICAgICAgY29uc3QgcGF0aCA9ICdodHRwOi8vJyArIHRoaXMucm9vdF9hcGkgKyAnOjUwMDEvY2hhbmdlbGFiZWwnOwoKICAgICAgYXhpb3MucG9zdChwYXRoLCB7ICdsYWJlbF9pZCc6IGxhYmVsX2lkLCAnZG9jdW1lbnRfaWQnOiB0aGlzLmN1cnJlbnRpZHgsICdwcm9qZWN0X2lkJzogdGhpcy5wcm9qZWN0aWR9LAogICAgICAgICAgICAgICAgICAgICAgICB7aGVhZGVyczogeydBdXRob3JpemF0aW9uJzogbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2p3dCcpfX0pCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgRXZlbnRCdXMuJGVtaXQoImxhYmVsLWFkZGVkIiwgdGhpcy5jdXJyZW50aWR4KTsKICAgICAgICAgIHRoaXMucmV0cmlldmVBbm5vdGF0ZWREb2N1bWVudCh0aGlzLmN1cnJlbnRpZHgpCiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICB9KTsKICAgIH0sCgogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmN1cnJlbnRpZHggPSAxOyAvLyByaXNreS4udGhlIHN0YXJ0aW5nIGNvZGVyIG1pZ2h0IG5vdCBiZSBzZXQgdXAKICAgIGNvbnNvbGUubG9nKCdEb2N1bWVudCBsb2FkZWQgd2l0aCBjaWQ6ICcsIHRoaXMuY3VycmVudGlkeCk7CgogICAgdGhpcy5sb2FkUHJvamVjdCh0aGlzLnByb2plY3RfaWQpOyAvLyB0aGlzIGdpdmVzIHVzIHRoZSBhdmFpbGFibGUgbGFiZWxzCgogICAgLy8gLy8gRXZlbnQgbGlzdGVuZXIgZm9yIHByZXZpb3VzIGFuZCBuZXh0IGRvY3VtZW50CiAgICAvLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChlKSA9PiB7CiAgICAvLyAgIGlmIChlLmtleSA9PSAneScpIHsKICAgIC8vICAgICB0aGlzLmNoYW5nZWxhYmVsKDIpOwogICAgLy8gICB9CiAgICAvLyAgIGlmIChlLmtleSA9PSAnbicpIHsKICAgIC8vICAgICB0aGlzLmNoYW5nZWxhYmVsKDEpOwogICAgLy8gICB9CiAgICAvLyB9KTsKCiAgICBFdmVudEJ1cy4kb24oIm51bWJlci1hZGRlZCIsIG5ld0lkeCA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCdudW1iZXIgYWRkZWQgY2FsbGVkJykKICAgICAgdGhpcy5jdXJyZW50aWR4ID0gbmV3SWR4OwogICAgICB0aGlzLmdldG5leHRkb2N1bWVudChuZXdJZHgpOwogICAgICAKICAgIH0pOwogIH0sCn07Cg=="},{"version":3,"sources":["Document.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Document.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<!-- eslint-disable max-len -->\n  <div class=\"document\">\n    <div class=\"card text-center\">\n      <div class=\"card-header\">\n        <div class=\"category\">\n          <div class=\"row\">\n            <div class=\"col-12\">\n              <div class=\"btn-group\" role=\"group\" v-for=\"(label, idx) in available_labels\" :key=\"label\">\n                    <button v-if=\"labels.includes(available_label_ids[idx])\" class=\"btn btn-primary\" type=\"button\" @click=\"changelabel(available_label_ids[idx])\"> {{label}} </button>\n                    <button v-else class=\"btn btn-secondary\" type=\"button\" @click=\"changelabel(available_label_ids[idx])\"> {{label}} </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"card-body\" id='document_text'>\n        <p class=\"card-text overflowAuto\">\n          <span>{{document_text}}</span>\n        </p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/*eslint-disable*/\n\nimport axios from 'axios';\nimport rangy from 'rangy';\nimport $ from 'jquery';\nimport { EventBus } from \"../main.js\";\n\nexport default {\n  name: 'Document',\n  props: {\n    msg: String,\n    projectid: Number,\n  },\n\n  data() {\n    return {\n      available_labels: [],\n      available_label_ids: [],\n      document_text: '',\n      labels: [],\n      spans: {},\n      spanvalues: [],\n      currentidx: Number, // this is current document_idx\n      root_api: process.env.VUE_APP_URL,\n    };\n  },\n  methods: {\n    \n    retrieveAnnotatedDocument(idx) {\n      const ann_document_pathpath = 'http://' + this.root_api + ':5001/getAnnotatedDocument';\n      axios.post(ann_document_pathpath, {'document_id': idx}, {headers: {'Authorization': localStorage.getItem('jwt')}})\n        .then((res) => {\n          this.labels = res.data.label_ids;\n          console.log('retrieve annotated document', idx)\n        })\n        .catch((error) => {\n          console.error(error);\n        });   \n    },\n\n    loadProject() {\n      const path = 'http://' + this.root_api + ':5001/getProject';\n      axios.post(path, {'project_id': this.projectid}, {headers: {'Authorization': localStorage.getItem('jwt')}})\n        .then((res) => {\n          this.available_labels = res.data.available_labels;\n          this.available_label_ids = res.data.available_label_ids;\n          console.log('loaded available labels')\n          var starting_document_id = res.data.starting_document_id;\n          this.getnextdocument(starting_document_id); // this needs to be logged to dataset and not document\n\n        })\n        .catch((error) => {\n          console.error(error);\n        });      \n    },\n\n    getnextdocument(newIdx) {\n      const document_path = 'http://' + this.root_api + ':5001/getDocument';\n      axios.post(document_path, {'document_id': newIdx}, {headers: {'Authorization': localStorage.getItem('jwt')}})\n        .then((res) => {\n          this.document_text = res.data.document_text;\n          // this.document_text = this.document_text.replace(new RegExp('\\r?\\n','g'), '<br/>');\n          this.retrieveAnnotatedDocument(newIdx);\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n\n    },\n\n    changelabel(label_id) {\n      const path = 'http://' + this.root_api + ':5001/changelabel';\n\n      axios.post(path, { 'label_id': label_id, 'document_id': this.currentidx, 'project_id': this.projectid},\n                        {headers: {'Authorization': localStorage.getItem('jwt')}})\n        .then((res) => {\n          EventBus.$emit(\"label-added\", this.currentidx);\n          this.retrieveAnnotatedDocument(this.currentidx)\n        })\n        .catch((error) => {\n          console.error(error);\n        });\n    },\n\n  },\n\n  created() {\n    this.currentidx = 1; // risky..the starting coder might not be set up\n    console.log('Document loaded with cid: ', this.currentidx);\n\n    this.loadProject(this.project_id); // this gives us the available labels\n\n    // // Event listener for previous and next document\n    // window.addEventListener('keydown', (e) => {\n    //   if (e.key == 'y') {\n    //     this.changelabel(2);\n    //   }\n    //   if (e.key == 'n') {\n    //     this.changelabel(1);\n    //   }\n    // });\n\n    EventBus.$on(\"number-added\", newIdx => {\n      console.log('number added called')\n      this.currentidx = newIdx;\n      this.getnextdocument(newIdx);\n      \n    });\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\ninput {\n  margin: 3px;\n}\nh3 {\n  margin: 0px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n.category {\n  text-align: left;\n  margin-top: 15px;\n}\n.overflowAuto {\n  overflow-y: auto;\n  height: 75vh;\n  word-wrap: break-word;\n}\n.document {\n  margin: 15px;\n}\n.btn-group {\n  margin: 5px;\n}\ndiv.boxwrap div {\n  float: left;\n}\ndiv.boxwrap div:hover {\n  background-color: aqua;\n  cursor: pointer;\n}\ndiv.boxwrap div h5 {\n  text-align: center;\n}\npre {\n  white-space: pre-wrap;\n  word-break: keep-all\n}\n</style>\n"]}]}