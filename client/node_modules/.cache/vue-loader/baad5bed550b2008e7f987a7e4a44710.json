{"remainingRequest":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/src/components/Progress.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/src/components/Progress.vue","mtime":1607124110633},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/kawsarnoor/Desktop/cogstack/annotationtool/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qZXNsaW50LWRpc2FibGUqLwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyBFdmVudEJ1cyB9IGZyb20gIi4uL21haW4uanMiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdQcm9nZXNzJywKICBwcm9wczogewogICAgbnVtYmVyczogTnVtYmVyLAogIH0sCiAgZGF0YSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBwcm9qZWN0aWQ6IE51bWJlciwKICAgICAgICBjdXJyZW50aWR4OiBOdW1iZXIsCiAgICAgICAgZG9jdW1lbnRfaWRzOiBbXSwKICAgICAgICBjb21wbGV0ZWRfaWRzOiBbXSwKICAgICAgICB2aWV3YWJsZV9kb2N1bWVudHM6IFtdLAogICAgICAgIGRvY3VtZW50c19wZXJfcGFnZTogTnVtYmVyLAogICAgICAgIHBhZ2VOdW1iZXI6IE51bWJlciwKICAgICAgICByb290X2FwaTogcHJvY2Vzcy5lbnYuVlVFX0FQUF9VUkwsCiAgICAgIH07CiAgfSwKICBtZXRob2RzOiB7CgogICAgbmV4dFBhZ2UoKSB7CiAgICAgICAgICAgY29uc29sZS5sb2coJ2dldHRpbmcgbmV4dCBwYWdlJykKCiAgICAgICAgICAgdGhpcy5wYWdlTnVtYmVyID0gdGhpcy5wYWdlTnVtYmVyICsgMQogICAgICAgICAgIHZhciB0b3BfZG9jID0gKHRoaXMucGFnZU51bWJlcikgKiB0aGlzLmRvY3VtZW50c19wZXJfcGFnZTsKICAgICAgICAgICB2YXIgYm90dG9tX2RvYyA9IHRvcF9kb2MgKyB0aGlzLmRvY3VtZW50c19wZXJfcGFnZTsKICAgICAgICAgICAKICAgICAgICAgICBpZiAodGhpcy5kb2N1bWVudF9pZHMuaW5jbHVkZXModG9wX2RvYysxKSkgewogICAgICAgICAgICAgICAgdGhpcy52aWV3YWJsZV9kb2N1bWVudHMgPSB0aGlzLmRvY3VtZW50X2lkcy5zbGljZSh0b3BfZG9jLCBib3R0b21fZG9jKQogICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgIHRoaXMucGFnZU51bWJlciA9IHRoaXMucGFnZU51bWJlciAtIDEKICAgICAgICAgICB9CiAgICB9LAogICAgCiAgICBwcmV2aW91c1BhZ2UoKSB7CgogICAgICAgIGNvbnNvbGUubG9nKCdnZXR0aW5nIHByZXZpb3VzIHBhZ2UnKQogICAgICAgIGlmICh0aGlzLnBhZ2VOdW1iZXIgPCAxKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5wYWdlTnVtYmVyID0gdGhpcy5wYWdlTnVtYmVyIC0gMQogICAgICAgIHZhciB0b3BfZG9jID0gKHRoaXMucGFnZU51bWJlcikgKiB0aGlzLmRvY3VtZW50c19wZXJfcGFnZQogICAgICAgIHZhciBib3R0b21fZG9jID0gdG9wX2RvYyArIHRoaXMuZG9jdW1lbnRzX3Blcl9wYWdlCiAgICAgICAgdGhpcy52aWV3YWJsZV9kb2N1bWVudHMgPSB0aGlzLmRvY3VtZW50X2lkcy5zbGljZSh0b3BfZG9jLCBib3R0b21fZG9jKQoKICAgIH0sCgogICAgZ29Ub0N1cnJlbnRJbmRleFBhZ2UoKSB7CgogICAgICAgIHZhciBsYXN0RG9jdW1lbnQgPSBNYXRoLm1heCguLi50aGlzLmNvbXBsZXRlZF9pZHMpCiAgICAgICAgdmFyIHBvcyA9ICh0aGlzLmRvY3VtZW50X2lkcykuaW5kZXhPZihsYXN0RG9jdW1lbnQpCiAgICAgICAgCiAgICAgICAgdGhpcy5wYWdlTnVtYmVyID0gTWF0aC5mbG9vcihwb3MvdGhpcy5kb2N1bWVudHNfcGVyX3BhZ2UpOwogICAgICAgIHZhciB0b3BfZG9jID0gKHRoaXMucGFnZU51bWJlcikgKiB0aGlzLmRvY3VtZW50c19wZXJfcGFnZQogICAgICAgIHZhciBib3R0b21fZG9jID0gdG9wX2RvYyArIHRoaXMuZG9jdW1lbnRzX3Blcl9wYWdlCgogICAgICAgIHRoaXMuY3VycmVudGlkeCA9IGxhc3REb2N1bWVudAogICAgICAgIHRoaXMudmlld2FibGVfZG9jdW1lbnRzID0gdGhpcy5kb2N1bWVudF9pZHMuc2xpY2UodG9wX2RvYywgYm90dG9tX2RvYykKICAgICAgICBjb25zb2xlLmxvZygnY29tcGxldGVkcGFnZScpCiAgICB9LAoKICAgIG5leHQoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRpZHggPCB0aGlzLmRvY3VtZW50X2lkcy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudGlkeCA9IHRoaXMuY3VycmVudGlkeCArIDE7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZ29pbmcgZm9yd2FyZCB0byBkb2N1bWVudCAnLCB0aGlzLmN1cnJlbnRpZHgpOwogICAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoIm51bWJlci1hZGRlZCIsIHRoaXMuY3VycmVudGlkeCk7IAoKICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRpZHggPiBNYXRoLm1heCguLi50aGlzLnZpZXdhYmxlX2RvY3VtZW50cykpewogICAgICAgICAgICAgICAgICAgIHRoaXMubmV4dFBhZ2UoKQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFbmQgb2YgZGF0YXNldCcpOwogICAgICAgICAgICB9CiAgICB9LAoKICAgIHByZXYoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRpZHggPiAxKSB7CiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRpZHggPSB0aGlzLmN1cnJlbnRpZHggLSAxOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dvaW5nIGJhY2sgdG8gZG9jdW1lbnQgJywgdGhpcy5jdXJyZW50aWR4KTsKICAgICAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCJudW1iZXItYWRkZWQiLCB0aGlzLmN1cnJlbnRpZHgpOyAKCiAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50aWR4IDwgTWF0aC5taW4oLi4udGhpcy52aWV3YWJsZV9kb2N1bWVudHMpKXsKICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzUGFnZSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3RhcnQgb2YgZGF0YXNldCcpOwogICAgICAgICAgICB9CiAgICB9LAoKICAgIGdvVG9Eb2N1bWVudChpKSB7CiAgICAgICAgdGhpcy5jdXJyZW50aWR4ID0gaTsKICAgICAgICBFdmVudEJ1cy4kZW1pdCgibnVtYmVyLWFkZGVkIiwgaSk7CiAgICB9CgogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICAKICAgIC8vIFJlZnJlc2ggcGFnZSBhdCBzdGFydCBvZiBjb21wb25lbnQgY3JlYXRpb24uIElzIHRoZXJlIGEgbW9yZSBWdWUtaXNoIHdheSBvZiBkb2luZyB0aGlzPwogICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmb3JjZVJlZnJlc2gnKSA9PT0gJ3JlZnJlc2gnKSB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2ZvcmNlUmVmcmVzaCcsICcnKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICB9CgogICAgdGhpcy5wcm9qZWN0aWQgPSAxOwogICAgdGhpcy5jdXJyZW50aWR4ID0gMTsgLy8gcmV0cmlldmUgdXNpbmcgYXBpCiAgICB0aGlzLnBhZ2VOdW1iZXIgPSAtMTsKICAgIHRoaXMuZG9jdW1lbnRzX3Blcl9wYWdlID0gMTAKCiAgICBjb25zb2xlLmxvZygnUHJvZ3Jlc3NzIGxvYWRlZCB3aXRoIGNpZDogJywgdGhpcy5jdXJyZW50aWR4KTsKCiAgICBjb25zdCBwYXRoID0gJ2h0dHA6Ly8nICsgdGhpcy5yb290X2FwaSArICc6NTAwMS9nZXRDb21wbGV0ZWQnOwogICAgYXhpb3MucG9zdChwYXRoLCB7J3Byb2plY3RfaWQnOiB0aGlzLnByb2plY3RpZH0sIHtoZWFkZXJzOiB7J0F1dGhvcml6YXRpb24nOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnand0Jyl9fSkKICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLmRvY3VtZW50X2lkcyA9IHJlcy5kYXRhLmRvY3VtZW50X2lkczsKICAgICAgICB0aGlzLmNvbXBsZXRlZF9pZHMgPSByZXMuZGF0YS5jb21wbGV0ZWRfaWRzOwogICAgICAgIAogICAgICAgIC8vIGxvYWQgaW4gZmlyc3QgeCBkb2N1bWVudHMKICAgICAgICB0aGlzLm5leHRQYWdlKCk7CgogICAgfSkKICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgIH0pOwoKICAgIC8vIEV2ZW50IGxpc3RlbmVyIGZvciBwcmV2aW91cyBhbmQgbmV4dCBkb2N1bWVudAogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4gewogICAgICBpZiAoZS5rZXkgPT0gJ0Fycm93TGVmdCcpIHsKICAgICAgICB0aGlzLnByZXYoKTsKICAgICAgfQogICAgICBpZiAoZS5rZXkgPT0gJ0Fycm93UmlnaHQnKSB7CiAgICAgICAgdGhpcy5uZXh0KCk7CiAgICAgIH0KICAgIH0pOwoKICAgIEV2ZW50QnVzLiRvbigibGFiZWwtYWRkZWQiLCBpZHggPT4gewogICAgICBjb25zb2xlLmxvZygnbGFiZWwtYWRkZWQ6ICcsaWR4KTsKICAgICAgaWYgKCF0aGlzLmNvbXBsZXRlZF9pZHMuaW5jbHVkZXMoaWR4KSkgewogICAgICAgICAgICBjb25zdCBwYXRoID0gJ2h0dHA6Ly8nICsgdGhpcy5yb290X2FwaSArICc6NTAwMS9nZXRDb21wbGV0ZWQnOwogICAgICAgICAgICBheGlvcy5wb3N0KHBhdGgsIHsncHJvamVjdF9pZCc6IHRoaXMucHJvamVjdGlkfSwge2hlYWRlcnM6IHsnQXV0aG9yaXphdGlvbic6IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdqd3QnKX19KQogICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50X2lkcyA9IHJlcy5kYXRhLmRvY3VtZW50X2lkczsKICAgICAgICAgICAgICAgIHRoaXMuY29tcGxldGVkX2lkcyA9IHJlcy5kYXRhLmNvbXBsZXRlZF9pZHM7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICB9KTsKICAgICAgfQogICAgICB0aGlzLm5leHQoKTsKICAgIH0pOwoKICB9CgogIAp9Owo="},{"version":3,"sources":["Progress.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA","file":"Progress.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<!-- eslint-disable -->\n    <div class=\"container\" id=\"progress\">\n        <!-- <img alt=\"Vue logo\" src=\"../assets/uclh.png\" style=\"max-width: 60%\"> -->\n        <div class=\"card text-center\" style=\"display: inline-block;\">\n            <div class=\"card-header\">\n                <div class=\"column is-two-thirds\">Finished {{ completed_ids.length}} of {{ document_ids.length}} </div>\n                <span class=\"column\" @click=\"goToCurrentIndexPage()\"><a><i class=\"fa fa-bookmark fa-1x\"></i></a></span>\n            </div>\n            <div class=\"list-group list-group-flush\">\n                <template v-for=\"(docindx, idx) in viewable_documents\">\n                    <div class=\"btn-group\" :key=\"docindx\" role=\"group\" aria-label=\"Basic example\">\n                        <div class=\"input-group-prepend\">\n                            <div class=\"input-group-text\" id=\"btnGroupAddon\">{{ docindx }}</div>\n                        </div>\n                        <button v-if=\"docindx==currentidx\" :key=\"docindx\"  type=\"button\" class=\"list-group-item list-group-item-action active\" @click=\"goToDocument(docindx)\"><span v-if=\"completed_ids.includes(docindx)\"  style='font-size:15px;'>&#10004;</span> Doc {{ docindx }}</button>\n                        <button v-else type=\"button\" :key=\"docindx\"  class=\"list-group-item list-group-item-action\" @click=\"goToDocument(docindx)\"><span v-if=\"completed_ids.includes(docindx)\"  style='font-size:15px;'>&#10004;</span> Doc {{ docindx }}</button>\n                    </div>\n                </template>\n            </div>\n        </div>\n        <div>\n            <button class=\"btn btn-primary\" type=\"button\" style=\"margin-right: 15px; margin-top: 10px;\" @click=\"previousPage()\">Prev</button>\n            <button class=\"btn btn-primary\" type=\"button\" style=\"margin-left: 15px; margin-top: 10px;\" @click=\"nextPage()\">Next</button>\n        </div>\n    </div>\n</template>\n\n<script>\n/*eslint-disable*/\nimport axios from 'axios';\nimport { EventBus } from \"../main.js\";\n\nexport default {\n  name: 'Progess',\n  props: {\n    numbers: Number,\n  },\n  data() {\n      return {\n        projectid: Number,\n        currentidx: Number,\n        document_ids: [],\n        completed_ids: [],\n        viewable_documents: [],\n        documents_per_page: Number,\n        pageNumber: Number,\n        root_api: process.env.VUE_APP_URL,\n      };\n  },\n  methods: {\n\n    nextPage() {\n           console.log('getting next page')\n\n           this.pageNumber = this.pageNumber + 1\n           var top_doc = (this.pageNumber) * this.documents_per_page;\n           var bottom_doc = top_doc + this.documents_per_page;\n           \n           if (this.document_ids.includes(top_doc+1)) {\n                this.viewable_documents = this.document_ids.slice(top_doc, bottom_doc)\n           } else {\n               this.pageNumber = this.pageNumber - 1\n           }\n    },\n    \n    previousPage() {\n\n        console.log('getting previous page')\n        if (this.pageNumber < 1) {\n            return;\n        }\n        this.pageNumber = this.pageNumber - 1\n        var top_doc = (this.pageNumber) * this.documents_per_page\n        var bottom_doc = top_doc + this.documents_per_page\n        this.viewable_documents = this.document_ids.slice(top_doc, bottom_doc)\n\n    },\n\n    goToCurrentIndexPage() {\n\n        var lastDocument = Math.max(...this.completed_ids)\n        var pos = (this.document_ids).indexOf(lastDocument)\n        \n        this.pageNumber = Math.floor(pos/this.documents_per_page);\n        var top_doc = (this.pageNumber) * this.documents_per_page\n        var bottom_doc = top_doc + this.documents_per_page\n\n        this.currentidx = lastDocument\n        this.viewable_documents = this.document_ids.slice(top_doc, bottom_doc)\n        console.log('completedpage')\n    },\n\n    next() {\n            if (this.currentidx < this.document_ids.length) {\n                this.currentidx = this.currentidx + 1;\n                console.log('going forward to document ', this.currentidx);\n                EventBus.$emit(\"number-added\", this.currentidx); \n\n                if (this.currentidx > Math.max(...this.viewable_documents)){\n                    this.nextPage()\n                }\n\n            }\n            else {\n                console.log('End of dataset');\n            }\n    },\n\n    prev() {\n            if (this.currentidx > 1) {\n                this.currentidx = this.currentidx - 1;\n                console.log('going back to document ', this.currentidx);\n                EventBus.$emit(\"number-added\", this.currentidx); \n\n                if (this.currentidx < Math.min(...this.viewable_documents)){\n                    this.previousPage()\n                }\n            }\n            else {\n                console.log('Start of dataset');\n            }\n    },\n\n    goToDocument(i) {\n        this.currentidx = i;\n        EventBus.$emit(\"number-added\", i);\n    }\n\n  },\n\n  created() {\n    \n    // Refresh page at start of component creation. Is there a more Vue-ish way of doing this?\n    if (localStorage.getItem('forceRefresh') === 'refresh') {\n        localStorage.setItem('forceRefresh', '');\n        window.location.reload();\n    }\n\n    this.projectid = 1;\n    this.currentidx = 1; // retrieve using api\n    this.pageNumber = -1;\n    this.documents_per_page = 10\n\n    console.log('Progresss loaded with cid: ', this.currentidx);\n\n    const path = 'http://' + this.root_api + ':5001/getCompleted';\n    axios.post(path, {'project_id': this.projectid}, {headers: {'Authorization': localStorage.getItem('jwt')}})\n    .then((res) => {\n        this.document_ids = res.data.document_ids;\n        this.completed_ids = res.data.completed_ids;\n        \n        // load in first x documents\n        this.nextPage();\n\n    })\n    .catch((error) => {\n        console.error(error);\n    });\n\n    // Event listener for previous and next document\n    window.addEventListener('keydown', (e) => {\n      if (e.key == 'ArrowLeft') {\n        this.prev();\n      }\n      if (e.key == 'ArrowRight') {\n        this.next();\n      }\n    });\n\n    EventBus.$on(\"label-added\", idx => {\n      console.log('label-added: ',idx);\n      if (!this.completed_ids.includes(idx)) {\n            const path = 'http://' + this.root_api + ':5001/getCompleted';\n            axios.post(path, {'project_id': this.projectid}, {headers: {'Authorization': localStorage.getItem('jwt')}})\n            .then((res) => {\n                this.document_ids = res.data.document_ids;\n                this.completed_ids = res.data.completed_ids;\n            })\n            .catch((error) => {\n                console.error(error);\n            });\n      }\n      this.next();\n    });\n\n  }\n\n  \n};\n</script>\n\n<style scoped>\n\n#progress{\n    background-color: white;\n    padding: 0px 0px;\n}\n.overflowAuto {\n  overflow-x: hidden;\n  overflow-y: auto;\n  height: calc(100vh - 600px);\n}\n\n.list-group{\n    max-height: 500px;\n    margin-bottom: 10px;\n    overflow:scroll;\n    -webkit-overflow-scrolling: touch;\n}\n\n\n</style>\n"]}]}